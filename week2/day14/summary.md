# Day 14 학습 요약: 코드로 인프라 관리하기, CloudFormation

## ① IaC의 장점

Infrastructure as Code(IaC)는 코드를 통해 인프라를 관리하는 방식으로, 다음과 같은 장점이 있습니다.

-   **속도:** 전체 인프라 스택을 수동으로 클릭하여 생성하는 대신, 코드를 실행하여 몇 분 만에 빠르고 자동으로 배포할 수 있습니다.
-   **일관성:** 동일한 템플릿 코드는 항상 동일한 결과물을 보장합니다. 이를 통해 개발, 스테이징, 프로덕션 환경 간의 차이로 인해 발생하는 '내 컴퓨터에서는 됐는데...' 같은 문제를 방지하고, 모든 환경의 일관성을 유지할 수 있습니다.
-   **버전 관리:** 인프라 구성(코드)을 Git과 같은 버전 관리 시스템으로 관리할 수 있습니다. 누가, 언제, 무엇을 변경했는지 모든 기록을 추적할 수 있으며, 문제가 발생했을 때 이전 버전으로 쉽게 롤백할 수 있습니다.

---

## ② CloudFormation 템플릿의 3요소

CloudFormation 템플릿은 여러 섹션으로 구성되지만, 가장 기본적인 핵심 요소는 Parameters, Resources, Outputs입니다.

-   **Parameters:** 템플릿을 실행할 때 외부에서 주입할 수 있는 **입력 변수**입니다. 이를 통해 인스턴스 유형, VPC ID, 암호 등을 하드코딩하지 않고 템플릿을 재사용할 수 있습니다.
-   **Resources:** 템플릿의 **가장 핵심적인 부분**으로, 실제로 생성할 AWS 리소스(EC2, S3, VPC 등)와 그 속성을 정의하는 곳입니다.
-   **Outputs:** 스택 생성이 완료된 후 사용자에게 보여줄 **결과 값**입니다. 생성된 웹 서버의 URL, S3 버킷 이름 등 중요한 정보를 쉽게 확인할 수 있도록 해줍니다.

---

## ③ 스택 드리프트(Stack Drift)

CloudFormation에서 **'드리프트(Drift)'**란, CloudFormation 템플릿에 정의된 **'기대 상태'**와 실제 AWS에 배포된 리소스의 **'현재 상태'**가 일치하지 않는 것을 의미합니다.

드리프트는 주로 CloudFormation을 통하지 않고, AWS 관리 콘솔이나 CLI를 통해 **수동으로 리소스 설정을 변경**했을 때 발생합니다. 예를 들어, 템플릿에는 보안 그룹의 80번 포트만 열도록 정의했는데, 누군가 콘솔에서 급하게 443번 포트를 추가하면 드리프트가 감지됩니다. 이를 통해 코드와 실제 인프라 간의 불일치를 추적하고 관리할 수 있습니다.

---

Launching and Managing a Web Application with AWS CloudFormation (한국어) 실습 진행하였음. 

실습 개요

이 실습에서는 AWS CloudFormation을 사용하여 오토스케일링 그룹, Amazon Elastic Compute Cloud(EC2) 인스턴스, Elastic Load Balancing을 비롯한 다양한 AWS의 지원 제품 및 서비스로 웹 애플리케이션을 프로비저닝하고 업데이트하는 방법을 배웁니다.

첫 번째 부분에서는 AWS CloudFormation을 사용하여 간단한 리소스인 Amazon Simple Storage Service(S3) 버킷을 생성하고, AWS CloudFormation 스택을 삭제하는 경우 또는 롤백 중에 적용되는 다양한 보존 정책을 살펴봅니다.

두 번째 부분에서는 Amazon Linux 인스턴스를 사용하여 간단한 PHP 웹 애플리케이션을 프로비저닝합니다. 그런 다음, 기존 애플리케이션에 AWS CloudFormation 템플릿을 다시 적용하여 Amazon EC2 인스턴스 유형과 같은 일부 리소스 속성을 변경하는 방법을 알아봅니다. 마지막으로 Auto Scaling 구성에 따라 로드 밸런서 및 Auto Scaling 그룹을 추가합니다.

목표
이 실습을 마치면 다음을 수행할 수 있습니다.

AWS CloudFormation을 사용하여 Amazon Simple Storage Service(S3) 버킷을 생성합니다.
Amazon Linux AMI를 사용하여 간단한 PHP 웹 애플리케이션을 프로비저닝합니다.
기존 애플리케이션에 AWS CloudFormation 템플릿을 적용합니다.
AWS CloudFormation을 사용하여 기존 애플리케이션을 수정합니다.
AWS CloudFormation을 사용하여 애플리케이션에 IAM 역할 및 Elastic Load Balancing을 추가합니다.

## ④ 느낀 점

오늘은 CloudFormation을 통해 수동으로 하던 모든 인프라 구축 작업을 코드로 자동화하는 강력한 방법을 배웠다. 처음에는 간단한 S3 버킷 하나를 만드는 것부터 시작했지만, 실습 후반부에는 로드 밸런서와 오토 스케일링 그룹까지 포함된 완전한 웹 애플리케이션 스택을 코드로 배포하며 IaC의 진정한 힘을 느낄 수 있었다.

특히 기존 스택을 템플릿 수정만으로 업데이트하는 과정이 인상 깊었다. 이는 인프라를 '애완동물'처럼 하나하나 관리하는 것이 아니라, '가축'처럼 일관되게 관리하고 쉽게 교체할 수 있다는 클라우드 네이티브의 개념을 직접 체험하게 해준 경험이었다. YAML 코드의 양이 많아 처음에는 부담스러웠지만, 각 섹션이 어떤 역할을 하는지 이해하고 나니 거대한 아키텍처의 설계도가 한눈에 들어오는 것 같아 매우 흥미로웠다.